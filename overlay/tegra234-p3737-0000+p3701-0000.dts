// SPDX-License-Identifier: GPL-2.0
// Copyright (c) 2022-2023, NVIDIA CORPORATION & AFFILIATES.  All rights reserved.


/dts-v1/;
/plugin/;

#include "overlay/tegra234-overlay.dtsi"
#include "overlay/tegra234-thermal.dtsi"
#include "overlay/tegra234-thermal-shutdown.dtsi"
#include "overlay/tegra234-audio-dai-links-overlay.dtsi"
#include "overlay/tegra234-camera.dtsi"
#include "tegra234-status-overlay.dtsi"
#include "tegra234-p3737-0000.dtsi"
#include "tegra234-p3701-0000.dtsi"
#include "tegra234-dcb-p3737-0000-p3701-0000.dtsi"

/ {
	compatible = "nvidia,p3737-0000+p3701-0000";

	fragment-t234-p3737-p3701@0 {
		target-path = "/";
		__overlay__ {
			bus@0 {
				smmu_test {
					compatible = "nvidia,smmu_test";
					iommus = <&smmu_niso0 TEGRA234_SID_SMMU_TEST>;
					status = "okay";
				};
			};
		};
	};

	fragment-t234-p3737-p3701@5 {
		target-path = "/bus@0/i2c@31b0000";
		__overlay__ {
			nvidia,hw-instance-id = <0x5>;
		};
	};

	fragment-t234-p3737-p3701@10 {
		target-path = "/";
		__overlay__ {
			cpus {
				cpu_core_power_states {
					C1: c1 {
						compatible = "arm,idle-state";
						state-name = "Clock gated";
						wakeup-latency-us = <1>;
						min-residency-us = <1>;
						status = "okay";
					};

					C7: c7 {
						compatible = "arm,idle-state";
						state-name = "Core powergate";
						wakeup-latency-us = <5000>;
						arm,psci-suspend-param= <0x40000007>;
						min-residency-us = <30000>;
						status = "okay";
					};
				};

				cpu@0 {
					cpu-idle-states = <&C7>;
				};

				cpu@100 {
					cpu-idle-states = <&C7>;
				};

				cpu@200 {
					cpu-idle-states = <&C7>;
				};

				cpu@300 {
					cpu-idle-states = <&C7>;
				};

				cpu@10000 {
					cpu-idle-states = <&C7>;
				};

				cpu@10100 {
					cpu-idle-states = <&C7>;
				};

				cpu@10200 {
					cpu-idle-states = <&C7>;
				};

				cpu@10300 {
					cpu-idle-states = <&C7>;
				};

				cpu@20000 {
					cpu-idle-states = <&C7>;
				};

				cpu@20100 {
					cpu-idle-states = <&C7>;
				};

				cpu@20200 {
					cpu-idle-states = <&C7>;
				};

				cpu@20300 {
					cpu-idle-states = <&C7>;
				};
			};
		};
	};

	fragment-t234-p3737-p3701@23 {
		target-path = "/bus@0";
		__overlay__ {
			ethernet@6800000 {
				status = "okay";
				nvidia,mac-addr-idx = <0>;
				nvidia,max-platform-mtu = <16383>;
				/* 1=enable, 0=disable */
				nvidia,pause_frames = <1>;
				phy-handle = <&mgbe0_aqr113c_phy>;
				phy-mode = "10gbase-r";
				/* 0:XFI 10G, 1:XFI 5G, 2:USXGMII 10G, 3:USXGMII 5G */
				nvidia,phy-iface-mode = <0>;
				nvidia,phy-reset-gpio = <&gpio TEGRA234_MAIN_GPIO(Y, 1) 0>;
				nvidia,mdio_addr = <0>;

				mdio {
					compatible = "nvidia,eqos-mdio";
					#address-cells = <1>;
					#size-cells = <0>;

					mgbe0_aqr113c_phy: ethernet_phy@0 {
						compatible = "ethernet-phy-ieee802.3-c45";
						reg = <0x0>;
						nvidia,phy-rst-pdelay-msec = <150>; /* msec */
						nvidia,phy-rst-duration-usec = <221000>; /* usec */
						interrupt-parent = <&gpio>;
						interrupts = <TEGRA234_MAIN_GPIO(Y, 3) IRQ_TYPE_LEVEL_LOW>;
					};
				};
			};

 			hdr40_i2c1: i2c@c250000 { };
		};
	};
};
